<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-encrypting-sensitive-configuration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Encrypting sensitive configuration | Silta</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://silta.wunder.io/silta/docs/encrypting-sensitive-configuration"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Encrypting sensitive configuration | Silta"><meta data-rh="true" name="description" content="Certain information such as access tokens, secret keys, passwords, certificates etc. is considered as sensitive data thus should not be committed to the repository as plain text."><meta data-rh="true" property="og:description" content="Certain information such as access tokens, secret keys, passwords, certificates etc. is considered as sensitive data thus should not be committed to the repository as plain text."><link data-rh="true" rel="icon" href="/silta/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://silta.wunder.io/silta/docs/encrypting-sensitive-configuration"><link data-rh="true" rel="alternate" href="https://silta.wunder.io/silta/docs/encrypting-sensitive-configuration" hreflang="en"><link data-rh="true" rel="alternate" href="https://silta.wunder.io/silta/docs/encrypting-sensitive-configuration" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://P70R8SQEIU-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Encrypting sensitive configuration","item":"https://silta.wunder.io/silta/docs/encrypting-sensitive-configuration"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Silta" href="/silta/opensearch.xml"><link rel="stylesheet" href="/silta/assets/css/styles.88f95edb.css">
<script src="/silta/assets/js/runtime~main.8c90b6f3.js" defer="defer"></script>
<script src="/silta/assets/js/main.df3556bb.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/silta/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/silta/"><div class="navbar__logo"><img src="/silta/img/logo.svg" alt="Wunder Silta" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/silta/img/logo.svg" alt="Wunder Silta" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/silta/docs/anatomy-of-silta">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/wunderio/silta" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/silta/docs/anatomy-of-silta">Docs</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/anatomy-of-silta">Silta project build process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/circleci-conf-examples">CircleCI configuration examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/creating-new-project">Creating a new project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/deployment-workflow">Deployment workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/docker-images">Docker images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/silta/docs/encrypting-sensitive-configuration">Encrypting sensitive configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/go-live-checklist">Go-live checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/help-with-silta-dev">Helping with Silta development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/key-components">Key components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/migrating-an-existing-drupal-project">Migrating an existing Drupal project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/request-workflow">Request workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/configuring-cdn">Configuring CDN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/silta-examples">Silta examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/troubleshooting">Troubleshooting</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/silta/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Docs</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Encrypting sensitive configuration</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Encrypting sensitive configuration</h1></header><p>Certain information such as access tokens, secret keys, passwords, certificates etc. is considered as sensitive data thus should not be committed to the repository as plain text.</p>
<p>Silta supports encryption/decryption of such information via <a href="https://github.com/wunderio/silta-cli" target="_blank" rel="noopener noreferrer">silta-cli</a>, furthermore, <em>silta-cli</em> can be used both locally and during the build/deploy, thus making the process simple and consistent. Official documentation of <em>silta-cli</em> can be found <a href="https://github.com/wunderio/silta-cli" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="encryption--decryption">Encryption &amp; decryption<a href="#encryption--decryption" class="hash-link" aria-label="Direct link to Encryption &amp; decryption" title="Direct link to Encryption &amp; decryption">​</a></h2>
<p>To encrypt a file for secure storing within repository, <code>silta secrets encrypt</code> command is used. When used in Silta, encrypted files have to be decrypted during the build or deployment to take effect. See the walkthrough example below.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-get-the-encryption-key">1. Get the encryption key<a href="#1-get-the-encryption-key" class="hash-link" aria-label="Direct link to 1. Get the encryption key" title="Direct link to 1. Get the encryption key">​</a></h3>
<p>Please refer to the section related to <a href="#encryption-keys">encryption keys</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-create-and-encrypt-the-file-containing-sensitive-information">2. Create and encrypt the file containing sensitive information<a href="#2-create-and-encrypt-the-file-containing-sensitive-information" class="hash-link" aria-label="Direct link to 2. Create and encrypt the file containing sensitive information" title="Direct link to 2. Create and encrypt the file containing sensitive information">​</a></h3>
<p><code>silta-cli</code> allows to encrypt any file, i.e. it can be Silta configuration file containing sensitive data within environment variables or TLS certificates, an actual TLS certificate file located at <code>/secrets/server.crt</code> or anything else. Below are some examples:</p>
<ul>
<li>Sensitive Silta configuration for Drupal chart</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">php</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hashsalt</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> super</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">IMPORTANT_API_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> super</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><br></span></code></pre></div></div>
<ul>
<li>Sensitive Silta configuration for Frontend chart</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">node</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">IMPORTANT_API_KEY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> super</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><br></span></code></pre></div></div>
<p>Once you have the file ready for encryption, run:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silta secrets encrypt --file /path/to/file --secret-key &lt;secret-key&gt;</span><br></span></code></pre></div></div>
<p>Or, if you have the encryption key stored as a local environment variable, use that as a reference instead:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silta secrets encrypt --file /path/to/file --secret-key-env ENV_VAR_NAME</span><br></span></code></pre></div></div>
<p>Note that <code>silta secrets encrypt</code> encrypts the source file itself unless you specify a different target path via the <code>--output-file</code> flag (see full docs <a href="https://github.com/wunderio/silta-cli/blob/master/docs/silta_secrets_encrypt.md" target="_blank" rel="noopener noreferrer">here</a>)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-add-decryption-to-circleci-configuration">3. Add decryption to CircleCI configuration<a href="#3-add-decryption-to-circleci-configuration" class="hash-link" aria-label="Direct link to 3. Add decryption to CircleCI configuration" title="Direct link to 3. Add decryption to CircleCI configuration">​</a></h3>
<p>When used in Silta, files have to be decrypted to take effect. For this you need to alter the relevant build/deploy jobs, you can use one of the two options below.</p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="decrypt_files-parameter"><code>decrypt_files</code> parameter<a href="#decrypt_files-parameter" class="hash-link" aria-label="Direct link to decrypt_files-parameter" title="Direct link to decrypt_files-parameter">​</a></h4>
<p>Caveats:</p>
<ul>
<li><code>decrypt_files</code> is only supported in <code>silta/drupal-build-deploy</code>, <code>silta/drupal-build</code> and <code>silta/drupal-deploy</code> jobs, thus only the Drupal chart</li>
<li>You can&#x27;t specify a custom encryption key</li>
</ul>
<p>Advantages:</p>
<ul>
<li>simpler configuration, no need to specify or generate an encryption key - one defined in <a href="/silta/docs/circleci-context">CircleCI context</a> (<code>SECRET_KEY</code>) is used. Note that it&#x27;s expected that secrets are encrypted with the same key locally (to get the key, refer to <a href="#encryption-keys">encryption keys</a> section).</li>
</ul>
<p>Usage example:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">decrypt_files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> path/to/encrypted/file</span><br></span></code></pre></div></div>
<ul>
<li><code>path/to/encrypted/file</code> is relative to the build folder (root)</li>
</ul>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="codebase-build-or-pre-release-parameter-with-a-decrypt-files-command-in-it-recommended"><code>codebase-build</code> or <code>pre-release</code> parameter with a <code>decrypt-files</code> command in it (recommended)<a href="#codebase-build-or-pre-release-parameter-with-a-decrypt-files-command-in-it-recommended" class="hash-link" aria-label="Direct link to codebase-build-or-pre-release-parameter-with-a-decrypt-files-command-in-it-recommended" title="Direct link to codebase-build-or-pre-release-parameter-with-a-decrypt-files-command-in-it-recommended">​</a></h4>
<p>This approach has slightly more complex configuration however it also has more advantages:</p>
<ul>
<li>Allows to specify a custom encryption key</li>
<li>Supported by all charts:<!-- -->
<ul>
<li>Drupal (<code>silta/drupal-build</code>, <code>silta/drupal-deploy</code>, <code>silta/drupal-build-deploy</code> jobs). Note: use <code>pre-release</code> parameter in <code>silta/drupal-deploy</code></li>
<li>Frontend (<code>silta/frontend-build-deploy</code> job)</li>
<li>Simple (<code>silta/simple-build-deploy</code> job)</li>
</ul>
</li>
</ul>
<p>Usage examples:</p>
<p>In <code>silta/drupal-build</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">codebase-build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">silta/decrypt-files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sso/saml.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">secret_key_env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MY_PROJECT_SECRET_KEY</span><br></span></code></pre></div></div>
<p>In <code>silta/drupal-deploy</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">pre-release</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">silta/decrypt-files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> silta/secrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">secret_key_env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MY_PROJECT_SECRET_KEY</span><br></span></code></pre></div></div>
<ul>
<li>Note: If you don&#x27;t specify the <code>secret_key_env</code> parameter, default encryption key from CircleCI context will be used as mentioned earlier.</li>
</ul>
<hr>
<p><em>Note for projects using <code>silta/drupal-build</code> and <code>silta/drupal-deploy</code></em></p>
<p>If project uses separate jobs for build and deploy, the job you add the decryption to depends on the use-case:</p>
<ul>
<li>if secret needs to be in a decrypted form during application runtime, i.e., TLS certificate for SSO integration, add it under <code>silta/drupal-build</code>.</li>
<li>if secret needs to be decrypted only during the deployment, i.e., Silta configuration file, add it under <code>silta/drupal-deploy</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="decrypting-existing-secrets-locally">Decrypting existing secrets locally<a href="#decrypting-existing-secrets-locally" class="hash-link" aria-label="Direct link to Decrypting existing secrets locally" title="Direct link to Decrypting existing secrets locally">​</a></h2>
<p>To inspect or alter information in encrypted files, you have to decrypt them locally.</p>
<ol>
<li>Get the encryption key (refer to the <a href="#encryption-keys">Secret keys</a> section of this document)</li>
<li>Run:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silta secrets decrypt --file /path/to/encrypted/file --secret-key &lt;secret-key&gt;</span><br></span></code></pre></div></div>
<p>or, if you have secret key stored as local environment variable:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">silta secrets decrypt --file /path/to/encrypted/file --secret-key-env ENV_VAR_NAME</span><br></span></code></pre></div></div>
<p>Note that <code>silta secrets decrypt</code> decrypts the source file itself unless you specify the<code>--output-file</code> flag. See full docs of the decryption command <a href="https://github.com/wunderio/silta-cli/blob/master/docs/silta_secrets_decrypt.md" target="_blank" rel="noopener noreferrer">here</a></p>
<p>Remember <strong>not to</strong> commit decrypted secret files!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="encryption-keys">Encryption keys<a href="#encryption-keys" class="hash-link" aria-label="Direct link to Encryption keys" title="Direct link to Encryption keys">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-new-projects">For new projects<a href="#for-new-projects" class="hash-link" aria-label="Direct link to For new projects" title="Direct link to For new projects">​</a></h3>
<p>It&#x27;s strongly recommended to create project-specific encryption keys or even environment specific ones for better security. Here&#x27;s a walkthrough example.</p>
<ol>
<li>In CircleCI, click &quot;Settings&quot; button in the top-right corner of your project&#x27;s overview page, then choose &quot;Environment variables&quot; from the sidebar on the left. Click &quot;Add environment variable&quot;. Name it something like <code>MY_PROJECT_SECRET_KEY</code> and generate a secure random value for it, i.e. on Unix based systems you can use this command:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">head -c 32 /dev/urandom | base64</span><br></span></code></pre></div></div>
<ol start="2">
<li>Use this key locally for encryption</li>
<li>Update your CircleCI configuration to use the same key, i.e., in <code>silta/drupal-build</code> add:</li>
</ol>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">codebase-build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">silta/decrypt-files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> path/to/file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">secret_key_env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MY_PROJECT_SECRET_KEY</span><br></span></code></pre></div></div>
<p>A few notes:</p>
<ul>
<li>You can refer to this example when switching encryption keys for an existing project. However, bear in mind that you must first locally decrypt existing secrets with <strong>the old encryption key</strong> and re-encrypt them with the new one for things to work.</li>
<li>Projects can have multiple encryption keys, i.e, one for development, one for staging and another one for production environment. If you choose to go this path, make sure you use the right key when encrypting/decrypting secrets per environment.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-existing-projects">For existing projects<a href="#for-existing-projects" class="hash-link" aria-label="Direct link to For existing projects" title="Direct link to For existing projects">​</a></h3>
<p>To get the encryption key from and existing project, follow the guide below.</p>
<ol>
<li>Determine name of the CircleCI environment variable the project uses for decryption. This can be done by inspecting project&#x27;s CircleCI configuration file and searching for <code>secret_key_env</code> references.</li>
</ol>
<hr>
<p><em>If references are found, i.e., <code>secret_key_env: MY_PROJECT_SECRET_KEY</code>.</em></p>
<p>This indicates that project utilises custom encryption key(s) stored in CircleCI&#x27;s environment variable(s).</p>
<hr>
<p><em>If references are not found</em></p>
<p>This indicates that project uses the default encryption key stored in CircleCI&#x27;s context as <code>SECRET_KEY</code> environment variable (reference to <a href="https://circleci.com/developer/orbs/orb/silta/silta#commands-decrypt-files" target="_blank" rel="noopener noreferrer">Silta CircleCI orb</a>). Note that project can utilise multiple contexts, check for <code>context</code> information in your CircleCI config to see which one is in use.</p>
<hr>
<ol start="2">
<li>Get value of the particular CircleCI environment variable, note that when inspecting via CircleCI UI values are redacted due to security reasons. To get the actual value of the env var, you must SSH into a CircleCI environment.</li>
<li>In CircleCI, go to your project&#x27;s pipelines page, find the last successful pipeline of the environment you need to get the encryption key for. Now find the job you&#x27;re interested in and rerun if with SSH (from top-right corner choose &quot;Rerun &gt; Rerun job with SSH&quot;).</li>
<li>Wait for the job to run until it&#x27;s successful and &quot;Waiting for SSH sessions&quot;. Use the SSH command from CircleCI&#x27;s output, it should look something like this:</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh -p 54782 50.19.60.152</span><br></span></code></pre></div></div>
<ol start="5">
<li>After SSH&#x27;ing into CircleCI env, run the following command to get the encryption key value (replace <code>MY_PROJECT_SECRET_KEY</code> with the actual env var name):</li>
</ol>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">printenv MY_PROJECT_SECRET_KEY</span><br></span></code></pre></div></div>
<ol start="6">
<li>Securely store the value locally for further use, i.e. set it as an environment variable</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/wunderio/silta/tree/master/docs/encrypting_sensitive_configuration.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/silta/docs/docker-images"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Docker images</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/silta/docs/go-live-checklist"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Go-live checklist</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#encryption--decryption" class="table-of-contents__link toc-highlight">Encryption &amp; decryption</a><ul><li><a href="#1-get-the-encryption-key" class="table-of-contents__link toc-highlight">1. Get the encryption key</a></li><li><a href="#2-create-and-encrypt-the-file-containing-sensitive-information" class="table-of-contents__link toc-highlight">2. Create and encrypt the file containing sensitive information</a></li><li><a href="#3-add-decryption-to-circleci-configuration" class="table-of-contents__link toc-highlight">3. Add decryption to CircleCI configuration</a></li></ul></li><li><a href="#decrypting-existing-secrets-locally" class="table-of-contents__link toc-highlight">Decrypting existing secrets locally</a></li><li><a href="#encryption-keys" class="table-of-contents__link toc-highlight">Encryption keys</a><ul><li><a href="#for-new-projects" class="table-of-contents__link toc-highlight">For new projects</a></li><li><a href="#for-existing-projects" class="table-of-contents__link toc-highlight">For existing projects</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/silta/docs/">Style Guide</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Social presence</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.facebook.com/wunder.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/wunder.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/Wunder_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.instagram.com/wunder.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCsBoaJt5sX12IFBu1giXZJg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://wunder.io/articles/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/wunderio/silta" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Wunder</div></div></div></footer></div>
</body>
</html>