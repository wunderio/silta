<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-troubleshooting" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Troubleshooting and FAQ | Silta</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://silta.wunder.io/silta/docs/troubleshooting"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Troubleshooting and FAQ | Silta"><meta data-rh="true" name="description" content="Q: Helm release fails due to existing resources"><meta data-rh="true" property="og:description" content="Q: Helm release fails due to existing resources"><link data-rh="true" rel="icon" href="/silta/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://silta.wunder.io/silta/docs/troubleshooting"><link data-rh="true" rel="alternate" href="https://silta.wunder.io/silta/docs/troubleshooting" hreflang="en"><link data-rh="true" rel="alternate" href="https://silta.wunder.io/silta/docs/troubleshooting" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://P70R8SQEIU-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Troubleshooting","item":"https://silta.wunder.io/silta/docs/troubleshooting"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Silta" href="/silta/opensearch.xml"><link rel="stylesheet" href="/silta/assets/css/styles.9a03ee38.css">
<script src="/silta/assets/js/runtime~main.a13dd921.js" defer="defer"></script>
<script src="/silta/assets/js/main.c0b04609.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/silta/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/silta/"><div class="navbar__logo"><img src="/silta/img/logo.svg" alt="Wunder Silta" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/silta/img/logo.svg" alt="Wunder Silta" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/silta/docs/anatomy-of-silta">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/wunderio/silta" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/silta/docs/anatomy-of-silta"><span title="Docs" class="categoryLinkLabel_W154">Docs</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/anatomy-of-silta"><span title="Silta project build process" class="linkLabel_WmDU">Silta project build process</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/circleci-conf-examples"><span title="CircleCI configuration examples" class="linkLabel_WmDU">CircleCI configuration examples</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/creating-new-project"><span title="Creating a new project" class="linkLabel_WmDU">Creating a new project</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/deployment-workflow"><span title="Deployment workflow" class="linkLabel_WmDU">Deployment workflow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/docker-images"><span title="Docker images" class="linkLabel_WmDU">Docker images</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/encrypting-sensitive-configuration"><span title="Encrypting sensitive configuration" class="linkLabel_WmDU">Encrypting sensitive configuration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/go-live-checklist"><span title="Go-live checklist" class="linkLabel_WmDU">Go-live checklist</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/help-with-silta-dev"><span title="Helping with Silta development" class="linkLabel_WmDU">Helping with Silta development</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/key-components"><span title="Key components" class="linkLabel_WmDU">Key components</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/migrating-an-existing-drupal-project"><span title="Migrating an existing Drupal project" class="linkLabel_WmDU">Migrating an existing Drupal project</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/request-workflow"><span title="Request workflow" class="linkLabel_WmDU">Request workflow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/configuring-cdn"><span title="Configuring CDN" class="linkLabel_WmDU">Configuring CDN</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/silta/docs/silta-examples"><span title="Silta examples" class="linkLabel_WmDU">Silta examples</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/silta/docs/troubleshooting"><span title="Troubleshooting" class="linkLabel_WmDU">Troubleshooting</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/silta/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Docs</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Troubleshooting</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Deployment issues</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-helm-release-fails-due-to-existing-resources">Q: Helm release fails due to existing resources<a href="#q-helm-release-fails-due-to-existing-resources" class="hash-link" aria-label="Direct link to Q: Helm release fails due to existing resources" title="Direct link to Q: Helm release fails due to existing resources" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p>kind PersistentVolume with the name &quot;project-123--branchname-someresource&quot; already exists in the cluster and wasn&#x27;t defined in the previous release.</p>
</blockquote>
<p>A: This error happens when a release that created a new resource failed.
The resource that is now in the way needs to be deleted, please ask someone with direct access to the cluster to do that.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-helm-deployment-fails-with-retry404-option">Q: Helm deployment fails with retry404 option<a href="#q-helm-deployment-fails-with-retry404-option" class="hash-link" aria-label="Direct link to Q: Helm deployment fails with retry404 option" title="Direct link to Q: Helm deployment fails with retry404 option" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p>[emerg] 1#1: unknown directive &quot;echo_sleep&quot; in /etc/nginx/conf.d/drupal.conf:292
nginx: [emerg] unknown directive &quot;echo_sleep&quot; in /etc/nginx/conf.d/drupal.conf:292</p>
</blockquote>
<p>A: Ensure you are using an nginx version with this <code>echo</code> module compiled in.
In silta/nginx.Dockerfile, the FROM instructive should point to one of the newer versions.</p>
<p>Versions available are listed here: <a href="https://github.com/wunderio/silta-images/tree/master/silta-nginx" target="_blank" rel="noopener noreferrer">https://github.com/wunderio/silta-images/tree/master/silta-nginx</a></p>
<p>Note: nginx<!-- -->:v0<!-- -->.1, wunderio/drupal Docker images do not have this module.</p>
<p>Example: <code>FROM wunderio/silta-nginx:1.17-v1</code></p>
<h1>Issues with the deployed environments</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-connect-to-silta-ssh">Q: How to connect to silta ssh?<a href="#q-how-to-connect-to-silta-ssh" class="hash-link" aria-label="Direct link to Q: How to connect to silta ssh?" title="Direct link to Q: How to connect to silta ssh?" translate="no">​</a></h2>
<p>A: SSH connection information is available in your circleci release notes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-there-is-no-connection-information-in-deployments-release-notes">Q: There is no connection information in deployment’s release notes!<a href="#q-there-is-no-connection-information-in-deployments-release-notes" class="hash-link" aria-label="Direct link to Q: There is no connection information in deployment’s release notes!" title="Direct link to Q: There is no connection information in deployment’s release notes!" translate="no">​</a></h2>
<p>A: SSH access is not enabled most likely.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-enable-ssh-access-to-project">Q: How to enable ssh access to project?<a href="#q-how-to-enable-ssh-access-to-project" class="hash-link" aria-label="Direct link to Q: How to enable ssh access to project?" title="Direct link to Q: How to enable ssh access to project?" translate="no">​</a></h2>
<p>A: See default values for the helm chart you are using for deployment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-error-connection-refused-when-connecting-via-ssh">Q: &quot;Error: Connection refused&quot; when connecting via SSH<a href="#q-error-connection-refused-when-connecting-via-ssh" class="hash-link" aria-label="Direct link to Q: &quot;Error: Connection refused&quot; when connecting via SSH" title="Direct link to Q: &quot;Error: Connection refused&quot; when connecting via SSH" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p>channel 0: open failed: connect failed: Connection refused
stdio forwarding failed
ssh_exchange_identification: Connection closed by remote host</p>
</blockquote>
<p>Possible causes:</p>
<ul>
<li>
<p>The <code>shell</code> pod is not done deploying. Wait for ten seconds and try again.</p>
</li>
<li>
<p>There is no <code>shell</code> access in frontend chart by default, You need to enable it (<code>shell.enabled: true</code>) and use customized base images from <a href="https://hub.docker.com/r/wunderio/silta-node" target="_blank" rel="noopener noreferrer">https://hub.docker.com/r/wunderio/silta-node</a></p>
</li>
<li>
<p>The environment has been downscaled to standby and has not been yet re-launched. Visit the environment URL and press the button to trigger upscaling.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-timeout-without-error-when-connecting-via-ssh">Q: Timeout without error when connecting via SSH<a href="#q-timeout-without-error-when-connecting-via-ssh" class="hash-link" aria-label="Direct link to Q: Timeout without error when connecting via SSH" title="Direct link to Q: Timeout without error when connecting via SSH" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p>ssh: connect to host ssh.[cluster.domain] port 22: Operation timed out
ssh_exchange_identification: Connection closed by remote host</p>
</blockquote>
<p>Possible causes:</p>
<ul>
<li>SSH access is IP restricted, You are probably not logged into the VPN.</li>
<li>SSH server just got restarted, wait couple minutes and try again</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-ssh-connection-asks-for-password-or-refuses-connection">Q: SSH connection asks for password or refuses connection<a href="#q-ssh-connection-asks-for-password-or-refuses-connection" class="hash-link" aria-label="Direct link to Q: SSH connection asks for password or refuses connection" title="Direct link to Q: SSH connection asks for password or refuses connection" translate="no">​</a></h2>
<p>Error message:</p>
<blockquote>
<p>ssh <a href="mailto:www-admin@master-shell.projectname" target="_blank" rel="noopener noreferrer">www-admin@master-shell.projectname</a> -J www-admin@ssh.[cluster.domain]
<a href="mailto:www-admin@master-shell.projecname" target="_blank" rel="noopener noreferrer">www-admin@master-shell.projecname</a>&#x27;s password:</p>
</blockquote>
<p>Error message 2:</p>
<blockquote>
<p>channel 0: open failed: connect failed: Connection refused
stdio forwarding failed
kex_exchange_identification: Connection closed by remote host</p>
</blockquote>
<p>Error message 3:</p>
<blockquote>
<p>channel 0: open failed: connect failed: Name does not resolve
stdio forwarding failed
kex_exchange_identification: Connection closed by remote host</p>
</blockquote>
<p>Possible causes:</p>
<ul>
<li>
<p>Shell container might be in unready state. Check pod via kubectl or silta dashboard (internal tool). And ensure all pods are running. If not, wait.</p>
</li>
<li>
<p>It’s possible your public key is not added to your github profile, make sure it is;</p>
</li>
<li>
<p>You are not project contributor in github, make sure you can push commits to repo;</p>
</li>
<li>
<p>Remove all occurrences of hostname (i.e. master-shell.projectname) from ~/.ssh/known_hosts</p>
</li>
<li>
<p>If you have changed the <code>clusterDomain</code> value in your silta configuration file, you need to set <code>shell.gitAuth.keyserver.url</code> to <code>https://keys.[cluster.domain]/api/1/git-ssh-keys</code>. Otherwise <a href="https://github.com/wunderio/silta-images/blob/master/shell/php-8.0/gitauth_keys.sh#L6" target="_blank" rel="noopener noreferrer">curl in public key download script</a> complains about broken certificate and the authentication does not work.</p>
</li>
<li>
<p>The ssh jumphost domain may be incorrect. Normally You&#x27;d get a full connection url in release notes, but if part of the domain is masked (****), don&#x27;t assume it to be silta.wdr.io. Actual domain replacement depends on the context (check TLDR answer for &quot;Secret masking and ************&quot; topic).</p>
</li>
</ul>
<p>If all above fails ask OPS team to check ssh-keyserver.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-ssh-connection-public-key-authentication-failure">Q: SSH connection public key authentication failure<a href="#q-ssh-connection-public-key-authentication-failure" class="hash-link" aria-label="Direct link to Q: SSH connection public key authentication failure" title="Direct link to Q: SSH connection public key authentication failure" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p><a href="mailto:username@X.X.X.X" target="_blank" rel="noopener noreferrer">username@X.X.X.X</a>: Permission denied (publickey).</p>
</blockquote>
<p>A: Authentication is based on your GitHub key, but there is trouble reading it. Use the key explicitly using <code>-i [path_to_identity_file]</code> option:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh X.X.X.X -i ~/.ssh/keys/wunder-github.rsa </span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-silta-website-asks-for-password-whats-the-password">Q: Silta website asks for password, what’s the password?<a href="#q-silta-website-asks-for-password-whats-the-password" class="hash-link" aria-label="Direct link to Q: Silta website asks for password, what’s the password?" title="Direct link to Q: Silta website asks for password, what’s the password?" translate="no">​</a></h2>
<p>A: Password is printed in circleci build release notes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-do-i-changedisable-site-password">Q: How do i change/disable site password?<a href="#q-how-do-i-changedisable-site-password" class="hash-link" aria-label="Direct link to Q: How do i change/disable site password?" title="Direct link to Q: How do i change/disable site password?" translate="no">​</a></h2>
<p>A: Check chart default values file, nginx.basicauth section. Check <a href="/silta/docs/silta-examples">silta ​examples</a> for example snippet. Make changes in silta.yml or silta-prod.yml accordingly. You can also whitelist ip addresses to skip password request (do this with caution). Check nginx.noauthips in chart defaults.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-allow-access-only-based-on-ip">Q: How to allow access only based on IP?<a href="#q-how-to-allow-access-only-based-on-ip" class="hash-link" aria-label="Direct link to Q: How to allow access only based on IP?" title="Direct link to Q: How to allow access only based on IP?" translate="no">​</a></h2>
<p>A: There is no built-in solution for silta, but You can add custom nginx configuration snippet to achieve it.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">locationExtraConfig</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    allow 1.2.3.4/32;</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    deny all;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mariadb-or-elasticsearch-running-out-of-disk-space">Mariadb or Elasticsearch running out of disk space<a href="#mariadb-or-elasticsearch-running-out-of-disk-space" class="hash-link" aria-label="Direct link to Mariadb or Elasticsearch running out of disk space" title="Direct link to Mariadb or Elasticsearch running out of disk space" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p>The table ‘XYZ’ is full</p>
</blockquote>
<p>Stateful applications like MariaDB or Elasticsearch store their data in persistent data volumes. It is possible to resize (expand) those disks (only increasing storage is supported), but this is not yet integrated with the process of updating a statefulset.
You can change the requested size by setting the <code>elasticsearch.volumeClaimTemplate.resources.requests.storage</code> or <code>mariadb.master.persistence.size</code> field in the <code>silta.yml</code> for the appropriate service (<code>mariadb</code> or <code>elasticsearch</code>), but You also need ops interaction to patch the statefulset:</p>
<p>MariaDB storage request (re-check correct values with mariadb subchart if needed):</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">mariadb</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">master</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">persistence</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Database storage disk space allocation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Request assistance from ops team after changing this on existing deployment.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">size</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 5Gi</span><br></span></code></pre></div></div>
<p>Elasticsearch storage request (re-check correct values with elasticsearch subchart if needed):</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">elasticsearch</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">volumeClaimTemplate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Elasticsearch storage disk space allocation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Request assistance from ops team after changing this on existing deployment.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 5Gi</span><br></span></code></pre></div></div>
<p>If the size is less than 5Gi, set it to 5Gi. If it&#x27;s 5Gi or more, double the previous value.</p>
<p>Due to inability to patch immutable fields in mariadb statefulset, the next build will fail unless cluster administrator runs these commands manually:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">namespace=&quot;name-of-repository&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pvc=&quot;data-master-mariadb-0&quot; # Find this with kubectl get pvc -n $namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">statefulset=&quot;master-mariadb&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch pvc -n $namespace $pvc -p &#x27;{&quot;spec&quot;: {&quot;resources&quot;: {&quot;requests&quot;: {&quot;storage&quot;: &quot;5Gi&quot;}}}}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete statefulset  -n $namespace --cascade=orphan $statefulset</span><br></span></code></pre></div></div>
<p>NOTE: If updating pvc size you are met with error:</p>
<blockquote>
<p>error: persistentvolumeclaims &quot;xxx-xxx&quot; could not be patched: persistentvolumeclaims &quot;xxx-xxx&quot; is forbidden: only dynamically provisioned pvc can be resized and the storageclass that provisions the pvc must support resize</p>
</blockquote>
<p>Check that Kubernetes is running at least v1.16 and then edit the corresponding storageclass, &quot;standard&quot; (google kubernetes engine only) in this case:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl patch storageclass standard -p &#x27;{&quot;allowVolumeExpansion&quot;: true}&#x27;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-enable-persistent-storage-for-private-files-in-drupal-chart">Q: How to enable persistent storage for private files in drupal chart?<a href="#q-how-to-enable-persistent-storage-for-private-files-in-drupal-chart" class="hash-link" aria-label="Direct link to Q: How to enable persistent storage for private files in drupal chart?" title="Direct link to Q: How to enable persistent storage for private files in drupal chart?" translate="no">​</a></h2>
<p>Sometimes you&#x27;d also get error like this:</p>
<blockquote>
<p>(changing permissions of &#x27;private/&#x27;: Operation not permitted)</p>
</blockquote>
<p>A: There are good defaults for private files persistent storage already, You just have to enable it in silta.yml file. Check the mount defaults in chart defaults too.</p>
<p>Drupal chart:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">mounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">private-files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-do-i-enable-backups">Q: How do I enable backups?<a href="#q-how-do-i-enable-backups" class="hash-link" aria-label="Direct link to Q: How do I enable backups?" title="Direct link to Q: How do I enable backups?" translate="no">​</a></h2>
<p>A: Drupal chart: search &quot;backup&quot; in chart values file for the answer.</p>
<p>A: Frontend chart: Backups can be enabled via <code>backups.enabled: true</code> and it will back up mounts defined at <code>.Values.mounts</code>. There&#x27;s also an option to run custom commands during backup using <code>services.yourservice.backup.command</code> (see services section in chart values.yml). Keep in mind that once the container stops, the data that is not stored on a persistent storage (backed up) will disappear.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-do-i-know-backups-work">Q: How do i know backups work?<a href="#q-how-do-i-know-backups-work" class="hash-link" aria-label="Direct link to Q: How do i know backups work?" title="Direct link to Q: How do i know backups work?" translate="no">​</a></h2>
<p>A: Backup process is done in a dedicated pod with a specific instructions to make a backup. Check backup pod output in silta dashboard (i.e. <code>production-backup-1590113220-n4m7p</code>). If the pod state is <code>Succeeded</code>, it&#x27;s good. Check the logs too, you can see the backup content and size. The pod state is kept till the next backup is started.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-do-i-send-e-mails">Q: How do i send e-mails?<a href="#q-how-do-i-send-e-mails" class="hash-link" aria-label="Direct link to Q: How do i send e-mails?" title="Direct link to Q: How do i send e-mails?" translate="no">​</a></h2>
<p>A: Check silta documentation, &quot;<a href="/silta/docs/silta-examples#sending-e-mail">Sending e-mail</a>&quot; section</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-do-i-create-redirects">Q: How do i create redirects?<a href="#q-how-do-i-create-redirects" class="hash-link" aria-label="Direct link to Q: How do i create redirects?" title="Direct link to Q: How do i create redirects?" translate="no">​</a></h2>
<p>A: Check silta documentation, &quot;<a href="/silta/docs/silta-examples#add-redirects">Adding redirects</a>&quot; section</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-what-is-the-elasticsearch-host-address">Q: What is the Elasticsearch host address?<a href="#q-what-is-the-elasticsearch-host-address" class="hash-link" aria-label="Direct link to Q: What is the Elasticsearch host address?" title="Direct link to Q: What is the Elasticsearch host address?" translate="no">​</a></h2>
<p>A: Elasticsearch host address is available via <code>ELASTICSEARCH_HOST</code> environment variable.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-custom-certificate-is-not-found">Q: Custom certificate is not found<a href="#q-custom-certificate-is-not-found" class="hash-link" aria-label="Direct link to Q: Custom certificate is not found" title="Direct link to Q: Custom certificate is not found" translate="no">​</a></h2>
<p>Error:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ERROR: Error: template: drupal/templates/drupal-certificate.yaml:88:31: executing &quot;drupal/templates/drupal-certificate.yaml&quot; at &lt;b64enc&gt;: invalid value; expected string</span><br></span></code></pre></div></div>
<p>A: It&#x27;s possible that You have either:</p>
<ul>
<li>not defined <code>.Values.ssl</code> (or <code>.Values.exposeDomainsDefaults</code> or <code>.Values.exposeDomains.ssl</code>); or</li>
<li>have forgotten to provide this configuration file containing secrets to deployment (i.e. <code>silta_config</code> in for CircleCI Silta orb&#x27;s <code>silta/drupal-build-deploy</code> job or <code>--silta-config</code> for <code>silta ci release deploy</code> cli command).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-site-keeps-complaining-about-ssl-certificate">Q: Site keeps complaining about SSL certificate<a href="#q-site-keeps-complaining-about-ssl-certificate" class="hash-link" aria-label="Direct link to Q: Site keeps complaining about SSL certificate" title="Direct link to Q: Site keeps complaining about SSL certificate" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p>Warning: Potential Security Risk Ahead</p>
</blockquote>
<p>A: The SSL certificate is broken/incorrect. There are multiple types of certificates:</p>
<ul>
<li>
<p>Custom certificates. Most frequent issue is that the CA certificate is not added to the bundle. Add it both to &quot;tls.ca&quot; and &quot;tls.crt&quot; fields. The order of certificates is server.crt -&gt; intermediate.crt -&gt; root.crt.</p>
</li>
<li>
<p>Letsencrypt-staging. Unless You don&#x27;t need it specifically, change it to &quot;letsencrypt&quot;.</p>
</li>
<li>
<p>Letsencrypt. One of possible causes, is, You added the exposeDomain long before DNS was actually changed and certificate issuer has timed out. Try to deploy the exposeDomains as close to DNS change as possible next time! Ask ops support to remove cert-manager challenge resource, so it recreates validation pod and it triggers repeated validation.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-deployment-fails-due-to-misconfigured-memory-assignments">Q: Deployment fails due to misconfigured memory assignments<a href="#q-deployment-fails-due-to-misconfigured-memory-assignments" class="hash-link" aria-label="Direct link to Q: Deployment fails due to misconfigured memory assignments" title="Direct link to Q: Deployment fails due to misconfigured memory assignments" translate="no">​</a></h2>
<p>Error log example #1:</p>
<blockquote>
<p>Warning  Failed                  45s (x4 over 101s)  kubelet, [node-id]  Error: failed to create containerd task: OCI runtime create failed: container_linux.go: 349: starting container process caused &quot;process_linux.go:449: container init caused &quot;process_linux.go:415: setting cgroup config for procHooks process caused \&quot;failed to write \\\&quot;5\\\&quot; to \\\&quot;/sys/fs/cgroup/memory/kubepods/burstable/[pod-id]/php/memory.limit_in_bytes\\\&quot;: write /sys/fs/cgroup/memory/kubepods/burstable/[pod-id]/php/memory.limit_in_bytes: device or resource busy\&quot;&quot;&quot;: unknown</p>
</blockquote>
<p>Event log example #2</p>
<blockquote>
<p>Failed to create pod sandbox: rpc error: code = Unknown desc = failed to create containerd task: OCI runtime create failed: container_linux.go:349: starting container process caused &quot;process_linux.go:319: getting the final child&#x27;s pid from pipe caused &quot;EOF&quot;&quot;: unknown</p>
</blockquote>
<p>A: This happens due to misconfigured memory limits or requests. Most plausible cause, memory unit is &quot;m&quot; while it should be &quot;M&quot;.
Note: cpu resources, however, are defined with lower case &quot;m&quot; (millicpu). More on kubernetes resource management (and &quot;M&quot; vs &quot;Mi&quot;) here: <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-php-fpm-containers-print-read-only-file-system-error-on-startup">Q: PHP FPM containers print &quot;read-only file system&quot; error on startup<a href="#q-php-fpm-containers-print-read-only-file-system-error-on-startup" class="hash-link" aria-label="Direct link to Q: PHP FPM containers print &quot;read-only file system&quot; error on startup" title="Direct link to Q: PHP FPM containers print &quot;read-only file system&quot; error on startup" translate="no">​</a></h2>
<p>Error:</p>
<blockquote>
<p>2021/08/20 06:22:38 [ ERROR ] Error while parsing &#x27;/usr/local/etc/php-fpm.d/zz-custom.conf&#x27;: open /usr/local/etc/php-fpm.d/zz-custom.conf: read-only file system</p>
</blockquote>
<p>TLDR A: Can&#x27;t make it go away.</p>
<p>A: There are customizations we need to inject into containers, but the way kubernetes works, is it only allows to map those template configuration files as read only which php does not like (complains about).There are couple ideas (hacks) in some issue queues that we tried and did not succeed, but there are few others that we might try again one day. Until then - there&#x27;s that message. Related issue: <a href="https://github.com/kubernetes/kubernetes/issues/62099" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/kubernetes/issues/62099</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-encrypt-sensitive-information">Q: How to encrypt sensitive information?<a href="#q-how-to-encrypt-sensitive-information" class="hash-link" aria-label="Direct link to Q: How to encrypt sensitive information?" title="Direct link to Q: How to encrypt sensitive information?" translate="no">​</a></h2>
<p>A: Use openssl as described in silta docs in &quot;<a href="/silta/docs/encrypting-sensitive-configuration">Encrypting sensitive configuration</a>&quot;</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-change-the-webroot-for-drupal-chart">Q: How to change the webroot for drupal chart?<a href="#q-how-to-change-the-webroot-for-drupal-chart" class="hash-link" aria-label="Direct link to Q: How to change the webroot for drupal chart?" title="Direct link to Q: How to change the webroot for drupal chart?" translate="no">​</a></h2>
<p>By default, the webroot is configured to be in <code>/app/web</code>. This value can be changed in the Drupal chart, see example below.</p>
<p>Drupal chart:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">webRoot</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /app/docroot</span><br></span></code></pre></div></div>
<p>If you change this, make sure to check for any other references to <code>/app/web</code> or <code>web</code> in your project.</p>
<p>Some known references are:</p>
<ul>
<li><code>public-files</code> mount in this the Drupal chart (values.yaml file)</li>
<li><code>silta/nginx.Dockerfile</code></li>
<li><code>composer.json</code> &amp; <code>composer.lock</code></li>
<li><code>.dockerignore</code></li>
<li><code>.gitignore</code></li>
<li><code>.lando.yml</code></li>
<li><code>grumphp.yml</code></li>
<li><code>phpcs.xml</code></li>
</ul>
<p>You also need to add the following in <code>.circleci/config.yml</code> parameters and put your webRoot directory name as the value, for example <code>web</code> or <code>docroot</code>:</p>
<ul>
<li>Add parameter <code>web-root</code> to <code>silta/drupal-validate</code> job</li>
<li>Add parameter <code>nginx_build_context</code> to <code>silta/drupal-deploy-build</code> job</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-customize-container-images-of-silta-deployments">How to customize container images of Silta deployments?<a href="#how-to-customize-container-images-of-silta-deployments" class="hash-link" aria-label="Direct link to How to customize container images of Silta deployments?" title="Direct link to How to customize container images of Silta deployments?" translate="no">​</a></h2>
<p>Drupal chart requires 3 images by default, <code>nginx</code> image, <code>php</code> and <code>shell</code> image. Source Dockerfiles for the image building are located at <code>silta/nginx.Dockerfile</code>, <code>silta/php.Dockerfile</code> and <code>silta/shell.Dockerfile</code> by default.</p>
<p>Frontend chart dockerfiles depend on services You want to deploy. Normally the dockerfiles are located in <code>silta/</code> directory, i.e. <code>silta/node.Dockerfile</code>.</p>
<p>These dockerfiles use specially crafted base images that provide additional libraries and tools by default. See upstream image sources at <a href="https://github.com/wunderio/silta-images" target="_blank" rel="noopener noreferrer">https://github.com/wunderio/silta-images</a>.</p>
<p>You can install extra tools for Your project by editing dockerfiles. Let&#x27;s use shell container as an example:</p>
<p>Content of <a href="https://github.com/wunderio/drupal-project/blob/master/silta/shell.Dockerfile" target="_blank" rel="noopener noreferrer">silta/shell.Dockerfile</a>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Dockerfile for the Shell container.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM wunderio/silta-php-shell:php7.4-v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY --chown=www-data:www-data . /app</span><br></span></code></pre></div></div>
<ul>
<li>The <code>FROM</code> instruction initializes a new build stage and sets the Base Image for subsequent instructions. As such, a valid Dockerfile must start with a FROM instruction. The image can be any valid image – it is especially easy to start by pulling an image from the Public Repositories. In this  example it uses wunderio shell image, tagged with <code>php7.4-v0.1</code> tag.</li>
<li>The <code>COPY</code> instruction copies new files or directories from <code>.</code> (project&#x27;s root folder, but this can be adjusted) and adds them to the filesystem of the container at the path <code>/app</code></li>
</ul>
<p>If You need to copy extra files or install tools, You can add extra instructions, f.ex -</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">COPY --chown=bin files* /somedir/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apk add wget</span><br></span></code></pre></div></div>
<ul>
<li>The RUN instruction will execute any commands in a new layer on top of the current image and commit the results. The resulting committed image will be used for the next step in the Dockerfile.</li>
</ul>
<p>See Dockerfile refrence for more instructions: <a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/builder/</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-test-docker-images">Q: How to test docker images?<a href="#q-how-to-test-docker-images" class="hash-link" aria-label="Direct link to Q: How to test docker images?" title="Direct link to Q: How to test docker images?" translate="no">​</a></h2>
<p>If You want to test docker images locally, You&#x27;d need to install docker or other runtime that allows running docker images. This tutorial won&#x27;t list instructions for that and will assume You can run <code>docker</code> command (it also needs to be at least version 20.10 to be able to run alpine 3.14+ images. <a href="https://wiki.alpinelinux.org/wiki/Release_Notes_for_Alpine_3.14.0#faccessat2" target="_blank" rel="noopener noreferrer">Related document</a>).</p>
<p>Running a docker image:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it --entrypoint sh wunderio/silta-php-shell:php7.4-v1</span><br></span></code></pre></div></div>
<p>This will download shell image and run a shell inside it. Typing <code>exit</code> will quit and stop the container.</p>
<p>This also allows running other images like nginx:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># running official nginx image from https://hub.docker.com/_/nginx </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -p 8080:80 nginx </span><br></span></code></pre></div></div>
<p>This way You can also run silta images, as long as You have access to image repository. See &quot;<a href="#q-how-to-run-silta-images-locally">How to run silta image locally</a>&quot; for instructions.</p>
<p>If You want to test your customized dockerfile, You need to build the image and run it</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Build image and tag it with `shell_test_build` tag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker build -t shell_test_build -f silta/shell.Dockerfile .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run tagged image and and exec into it with `sh` shell </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it --entrypoint  sh shell_test_build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Remove test image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker image rm shell_test_build</span><br></span></code></pre></div></div>
<p>More about running docker images via docker cli at &quot;<a href="https://docs.docker.com/engine/reference/commandline/cli/" target="_blank" rel="noopener noreferrer">Docker Command-line reference</a>&quot;</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-how-to-run-silta-images-locally">Q: How to run Silta images locally?<a href="#q-how-to-run-silta-images-locally" class="hash-link" aria-label="Direct link to Q: How to run Silta images locally?" title="Direct link to Q: How to run Silta images locally?" translate="no">​</a></h2>
<p>TLDR: You can run those images locally, but there are missing resources (storage mounts, environment variables, secrets) that are only available in the cluster. You can still run containers and debug node applications if You have to.</p>
<p>If You want to run some silta image locally for debugging or other purpose, follow these steps:</p>
<ol>
<li>
<p>Make sure You have access to kubernetes cluster.</p>
<ul>
<li>Install kubectl kubernetes cli tool: <a href="https://kubernetes.io/docs/tasks/tools/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/tasks/tools/</a></li>
<li>Configure cluster access for kubectl (when using Google Kubernetes Engine): <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl" target="_blank" rel="noopener noreferrer">https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl</a></li>
<li>Try listing pod resources as an example (replace <code>drupal-project-k8s</code> with your repository name)<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods -n drupal-project-k8s</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>Get the docker image URL for the container You are need to run using kubectl:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get deployments -o wide -n drupal-project-k8s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                 READY   UP-TO-DATE   AVAILABLE   AGE     CONTAINERS        IMAGES                                                                                                                                                                                    SELECTOR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">master-drupal        1/1     1            1           448d    php,nginx         eu.gcr.io/[gcp-project]/drupal-project-k8s-php:v5-76e9f99eb3c4293fa14184b546bc1af980ea3760,eu.gcr.io/[gcp-project]/drupal-project-k8s-nginx:v5-bef5cba1137eaaa73a986bad07221bbab3ae5ca2   app=drupal,deployment=drupal,release=master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">master-shell         1/1     1            1           448d    shell             eu.gcr.io/[gcp-project]/drupal-project-k8s-shell:v6-3879d81221f34e79ff8674efca539c8d7410dd0a                                                                                              app=drupal,release=master,service=shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ul>
<li><code>drupal-project-k8s</code> is kubernetes namespace, in Silta it&#x27;s also a project name.</li>
<li><code>master-drupal</code> is drupal pod of <code>master</code> branch deployment</li>
<li><code>master-drupal</code> pod contains two containers, <code>nginx</code> and <code>drupal</code>. These containers are using two images (see &quot;IMAGES&quot; column). See Google Kubernetes Engine <a href="https://cloud.google.com/kubernetes-engine/docs/concepts/pod" target="_blank" rel="noopener noreferrer">Pod documentation</a> if you need to grasp the &quot;Pod&quot; concept. Pod resource is not GKE exclusive, this documentation applies to all kubernetes clusters.</li>
<li><code>master-shell</code> is a shell pod for <code>master</code> branch deployment.</li>
</ul>
</li>
<li>
<p>Make sure You have image pull access. Try pulling it:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker pull eu.gcr.io/[gcp-project]/drupal-project-k8s-shell:v6-3879d81221f34e79ff8674efca539c8d7410dd0a</span><br></span></code></pre></div></div>
<ul>
<li>If it fails, authenticate with Container Registry using gcloud helper: <a href="https://cloud.google.com/container-registry/docs/advanced-authentication#gcloud-helper" target="_blank" rel="noopener noreferrer">https://cloud.google.com/container-registry/docs/advanced-authentication#gcloud-helper</a>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  gcloud auth login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gcloud auth configure-docker</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
<li>
<p>Run Silta <code>shell</code> image:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it --entrypoint sh eu.gcr.io/[gcp-project]/drupal-project-k8s-shell:v6-3879d81221f34e79ff8674efca539c8d7410dd0a</span><br></span></code></pre></div></div>
<ul>
<li>You can&#x27;t run nginx image properly in local environment because silta mounts resources (storage, secrets, environment variables) that are only available in the cluster</li>
<li>There will be some resources (mounts) missing in shell container (i.e. no content in <code>sites/default/files</code>) and some environment variables missing.</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-cloudfront-responses-with-502-bad-gateway">Q: CloudFront responses with 502 Bad Gateway<a href="#q-cloudfront-responses-with-502-bad-gateway" class="hash-link" aria-label="Direct link to Q: CloudFront responses with 502 Bad Gateway" title="Direct link to Q: CloudFront responses with 502 Bad Gateway" translate="no">​</a></h2>
<p>It may be because of CDN using <code>https</code> origin request and Silta is not providing a valid certificate request.</p>
<p>You must verify that given domain has a verified certificate and is mapped correctly in the certificate under <code>SubjectName</code> and/or <code>CommonName</code>.</p>
<p>Assuming your:</p>
<ul>
<li><code>exposedDomain</code> index domain name is <code>cloudfront</code></li>
<li>namepsace: <code>my-project</code></li>
<li>branch is <code>develop</code></li>
</ul>
<p>...you may inspect your certificate with following command:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get develop-tls-cloudfront -n my-project -o json | jq -r &#x27;.data[&quot;tls.crt&quot;]&#x27; | base64 -d | openssl x509 -text</span><br></span></code></pre></div></div>
<p>In certificate details, confirm that <code>www.example.com</code> domain matches your CDN domain:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Subject: CN = www.example.com</span><br></span></code></pre></div></div>
<p>Otherwise you might need to delete TLS secret and restart the verification process.</p>
<p><a href="/silta/docs/configuring-cdn">Please read more about configuring CDN</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="q-drupal-is-generating-wrong-urls-with-cdn">Q: Drupal is generating wrong URLs with CDN<a href="#q-drupal-is-generating-wrong-urls-with-cdn" class="hash-link" aria-label="Direct link to Q: Drupal is generating wrong URLs with CDN" title="Direct link to Q: Drupal is generating wrong URLs with CDN" translate="no">​</a></h2>
<p>You may not be properly forwarding your <code>Host</code> header to the origin requests.</p>
<p>Drupal will pickup the scheme and hostname properly from request headers. If these are not properly forwarded, Drupal wont be able to initialize those and generate URLs properly.</p>
<p><a href="/silta/docs/configuring-cdn">Please read more about configuring CDN</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/wunderio/silta/tree/master/docs/troubleshooting.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/silta/docs/silta-examples"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Silta examples</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#q-helm-release-fails-due-to-existing-resources" class="table-of-contents__link toc-highlight">Q: Helm release fails due to existing resources</a></li><li><a href="#q-helm-deployment-fails-with-retry404-option" class="table-of-contents__link toc-highlight">Q: Helm deployment fails with retry404 option</a></li><li><a href="#q-how-to-connect-to-silta-ssh" class="table-of-contents__link toc-highlight">Q: How to connect to silta ssh?</a></li><li><a href="#q-there-is-no-connection-information-in-deployments-release-notes" class="table-of-contents__link toc-highlight">Q: There is no connection information in deployment’s release notes!</a></li><li><a href="#q-how-to-enable-ssh-access-to-project" class="table-of-contents__link toc-highlight">Q: How to enable ssh access to project?</a></li><li><a href="#q-error-connection-refused-when-connecting-via-ssh" class="table-of-contents__link toc-highlight">Q: &quot;Error: Connection refused&quot; when connecting via SSH</a></li><li><a href="#q-timeout-without-error-when-connecting-via-ssh" class="table-of-contents__link toc-highlight">Q: Timeout without error when connecting via SSH</a></li><li><a href="#q-ssh-connection-asks-for-password-or-refuses-connection" class="table-of-contents__link toc-highlight">Q: SSH connection asks for password or refuses connection</a></li><li><a href="#q-ssh-connection-public-key-authentication-failure" class="table-of-contents__link toc-highlight">Q: SSH connection public key authentication failure</a></li><li><a href="#q-silta-website-asks-for-password-whats-the-password" class="table-of-contents__link toc-highlight">Q: Silta website asks for password, what’s the password?</a></li><li><a href="#q-how-do-i-changedisable-site-password" class="table-of-contents__link toc-highlight">Q: How do i change/disable site password?</a></li><li><a href="#q-how-to-allow-access-only-based-on-ip" class="table-of-contents__link toc-highlight">Q: How to allow access only based on IP?</a></li><li><a href="#mariadb-or-elasticsearch-running-out-of-disk-space" class="table-of-contents__link toc-highlight">Mariadb or Elasticsearch running out of disk space</a></li><li><a href="#q-how-to-enable-persistent-storage-for-private-files-in-drupal-chart" class="table-of-contents__link toc-highlight">Q: How to enable persistent storage for private files in drupal chart?</a></li><li><a href="#q-how-do-i-enable-backups" class="table-of-contents__link toc-highlight">Q: How do I enable backups?</a></li><li><a href="#q-how-do-i-know-backups-work" class="table-of-contents__link toc-highlight">Q: How do i know backups work?</a></li><li><a href="#q-how-do-i-send-e-mails" class="table-of-contents__link toc-highlight">Q: How do i send e-mails?</a></li><li><a href="#q-how-do-i-create-redirects" class="table-of-contents__link toc-highlight">Q: How do i create redirects?</a></li><li><a href="#q-what-is-the-elasticsearch-host-address" class="table-of-contents__link toc-highlight">Q: What is the Elasticsearch host address?</a></li><li><a href="#q-custom-certificate-is-not-found" class="table-of-contents__link toc-highlight">Q: Custom certificate is not found</a></li><li><a href="#q-site-keeps-complaining-about-ssl-certificate" class="table-of-contents__link toc-highlight">Q: Site keeps complaining about SSL certificate</a></li><li><a href="#q-deployment-fails-due-to-misconfigured-memory-assignments" class="table-of-contents__link toc-highlight">Q: Deployment fails due to misconfigured memory assignments</a></li><li><a href="#q-php-fpm-containers-print-read-only-file-system-error-on-startup" class="table-of-contents__link toc-highlight">Q: PHP FPM containers print &quot;read-only file system&quot; error on startup</a></li><li><a href="#q-how-to-encrypt-sensitive-information" class="table-of-contents__link toc-highlight">Q: How to encrypt sensitive information?</a></li><li><a href="#q-how-to-change-the-webroot-for-drupal-chart" class="table-of-contents__link toc-highlight">Q: How to change the webroot for drupal chart?</a></li><li><a href="#how-to-customize-container-images-of-silta-deployments" class="table-of-contents__link toc-highlight">How to customize container images of Silta deployments?</a></li><li><a href="#q-how-to-test-docker-images" class="table-of-contents__link toc-highlight">Q: How to test docker images?</a></li><li><a href="#q-how-to-run-silta-images-locally" class="table-of-contents__link toc-highlight">Q: How to run Silta images locally?</a></li><li><a href="#q-cloudfront-responses-with-502-bad-gateway" class="table-of-contents__link toc-highlight">Q: CloudFront responses with 502 Bad Gateway</a></li><li><a href="#q-drupal-is-generating-wrong-urls-with-cdn" class="table-of-contents__link toc-highlight">Q: Drupal is generating wrong URLs with CDN</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/silta/docs/">Style Guide</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Social presence</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.facebook.com/wunder.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/wunder.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/Wunder_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.instagram.com/wunder.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCsBoaJt5sX12IFBu1giXZJg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://wunder.io/articles/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/wunderio/silta" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Wunder</div></div></div></footer></div>
</body>
</html>